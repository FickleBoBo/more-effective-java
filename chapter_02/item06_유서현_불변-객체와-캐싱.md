## 불변 객체와 캐싱


`Effective Java` 2장 객체 생성과 파괴 - '아이템 6. 불필요한 객체 생성을 피하라' 를 읽고

### 정리

**내용 요약**

1. 객체를 매번 생성하지 말고 재사용해라. 재사용은 빠르고 세련되다. **불변 객체**(심화 탐구)는 언제든 재사용 가능하다.

    ```java
    String s = new String("Java"); // BAD
    String s = "Java"; // GOOD
    ```
- 위쪽 코드는 실행될 때 마다 String 인스턴스를 새로 생성하므로 `String s = "Java"` 형태의 코드를 사용하여 하나의 String 인스턴스 사용을 권장한다.


2. 정적 팩터리 메서드 부분 (Item 01) 재등장 코드

    ```java
    Boolean b = new Boolean("true") // BAD
    Boolean b = Boolean.valueOf("true") // GOOD
    ```

    `Boolean` 생성자 대신 `.valueOf(String)` 팩터리 메서드를 사용 권장하고 있다.

3. 생성 비용이 아주 비싼 객체가 반복해서 필요하다면 **캐싱**(심화 탐구)해서 재사용하길 권한다. 자주 호출되는 상황에서 성능 개선이 이루어지며 코드 가독성도 좋아진다.


### 심화 탐구

**출발점**

캐싱이란 정확히 어떤 의미일까? 불변 객체는 언제든 재사용 가능하다던데 불변 객체란 무엇일까? Item 17에 나온다고는 하지만, 가변 객체와의 차이도 궁금하므로 우선 서술을 찾아보기로 했다.

**설명**

1. **불변 객체**
    - 객체 지향 프로그래밍에서 **불변(immutable) 객체**는 생성 후 그 상태를 바꿀 수 없는 객체를 말한다.
    - 반대 개념으로는 **가변(mutable) 객체**로 생성 후에도 상태를 변경할 수 있다.
    - 불변 객체를 사용하면 복제나 비교를 위한 조작을 단순화 할 수 있고, 성능 개선에도 도움을 준다.
    - 하지만 객체가 변경 가능한 데이터를 많이 가지고 있는 경우엔 불변이 오히려 부적절한 경우가 있다. 이 때문에 많은 프로그래밍 언어에서는 불변이나 가변 중 하나를 선택할 수 있도록 하고 있다.
    - 객체가 불변하기 위해서는 가변적 필드가 있는지 여부와 별개로, 외부에서 그 필드를 변경하는 방법이 존재하면 안되며 또 가변적인 필드를 접근하는 방법도 있어서는 안된다.

    또, 클래스가 불변인지 확인하는 하나의 방법으로 **FindBugs**라는 이클립스 플러그인을 이용 가능하다. 정적 분석을 사용하여 Java 코드의 버그를 찾는 프로그램으로 IDE와 연동되어 사용 가능하고, 코드 스타일, 오류, 성능 문제도 함께 검사 가능하다. 

2. 정적 분석과 동적 분석의 차이점

    두 분석의 가장 큰 차이점은 개발 수명주기에서 결함을 발견하는 위치이다.

    **정적 분석**(Static Analysis)은 프로그램을 실행하기 전에 (예: 코딩과 단위 테스트 사이) 결함을 식별한다.

    **동적 코드 분석**(Dynamic Analysis)은 프로그램을 실행한 후 (예: 단위 테스트 중) 결함을 식별한다.


3. **캐싱**

    **캐싱**(Caching)이란 간단하게 말해 저장한다는 뜻이다. 

    우선 ‘캐시(Cache)’ 란 데이터, 값을 미리 복사해 놓는 임시 장소를 의미한다.

    미리 복사를 해놓는 이유는 값을 다시 계산하거나, 데이터에 접근하는 시간을 줄일 수 있기 때문이다.

    즉 ‘캐싱’ 이란 위에서 말한 ‘캐시’에 저장한다는 뜻이다.

<br>

**어려웠던 부분**

- 지연 초기화 : 예시 코드를 찾아볼 예정이다.
- 어댑터 (어댑터를 뷰 라고도 한다) : 뷰에 대한 이해도 부족으로 추후 다시 읽어볼 예정이다.
- 오토박싱(auto boxing) : 한 번도 사용해본 적 없는 개념으로 직접 실습해보며 이해해보려 한다.


<br>


**참고 자료**

*[https://ko.wikipedia.org/wiki/불변객체](https://ko.wikipedia.org/wiki/%EB%B6%88%EB%B3%80%EA%B0%9D%EC%B2%B4)*

*https://www.perforce.com/blog/sca/what-static-analysis*

*https://findbugs.sourceforge.net/*

*https://opentutorials.org/course/697/3839*